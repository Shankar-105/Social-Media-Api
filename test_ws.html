<!DOCTYPE html>
<html>
<head>
  <title>WebSocket Test</title>
</head>
<body>
  <h1>FastAPI WebSocket Test</h1>
  <input type="text" id="message" placeholder="Type message" />
  <button onclick="send()">Send</button>
  <div id="output"></div>

  <script>
    // current logged in user for testing
    const userId = 14;
    // current jwt token from postman
    const token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjE0LCJ1c2VyTmFtZSI6Inlhc2giLCJleHBUaW1lIjoxNzYyMTAwNTQxfQ.tUx9U6xdNeB0Kjhn9yRTpz4e9CaDEvOfaO0ZYinVMlk"; // â† Paste your JWT here

    const ws = new WebSocket(`ws://127.0.0.1:8000/chat/ws/${userId}?token=${token}`);

    ws.onopen = () => {
      addMsg("Connected to WebSocket!");
    };

    ws.onmessage = (e) => {
      addMsg("Received: " + e.data);
    };

    ws.onerror = (e) => {
      addMsg("Error: " + e);
    };

    ws.onclose = () => {
      addMsg("Disconnected");
    };

    function send() {
      const msg = document.getElementById("message").value;
      ws.send(msg);
      addMsg("Sent: " + msg);
      document.getElementById("message").value = "";
    }

    function addMsg(text) {
      const div = document.createElement("div");
      div.textContent = text;
      document.getElementById("output").appendChild(div);
    }
  </script>
</body>
</html>